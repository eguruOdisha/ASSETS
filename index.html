<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Doubt Assistant</title>
    
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
           background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            min-height: 100vh;
            margin: 0;
            padding: 5px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 10px;
        }

        .chat-container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            height: 95vh;
        }

        .chat-header {
           background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            padding: 15px;
            text-align: center;
            position: relative;
           border-bottom: 3px solid #2563eb;
        }

        .chat-header h1 {
            font-size: 1.3rem;
            margin-bottom: 3px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            line-height: 1.3;
        }

        .chat-header p {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-top: 3px;
        }

        .study-icon {
            font-size: 2rem;
            margin: 8px 0;
            color: #ffd700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .home-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .home-button:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .chat-messages {
            flex: 1;
            padding: 12px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.6;
            animation: slideInUp 0.4s ease-out;
            position: relative;
            word-wrap: break-word;
            font-size: 0.95rem;
        }

        @keyframes slideInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

    .bot-message {
    background: linear-gradient(135deg, #e6f3ff 0%, #cce7ff 100%);
    border: 2px solid #b3d9ff;
    color: #1a365d;
    align-self: flex-start;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
    font-weight: 700;
    border-bottom-left-radius: 8px;
    text-align: justify;
}

        .user-message {
           background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            align-self: flex-end;
           box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
            border-bottom-right-radius: 8px;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
            width: 100%;
        }

        .option-button {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 12px 16px;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .option-button:hover {
            transform: translateY(-3px);
           box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4);
        }

        .option-button:active {
            transform: translateY(0px);
        }

        .option-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .option-button:hover::before {
            left: 100%;
        }

        .typing-indicator {
            display: inline-block;
            background: linear-gradient(135deg, #e6f3ff 0%, #cce7ff 100%);
            border: 2px solid #b3d9ff;
            padding: 15px 20px;
            border-radius: 20px;
            border-bottom-left-radius: 8px;
            margin-bottom: 10px;
        }

        .typing-indicator span {
            height: 10px;
            width: 10px;
            float: left;
            margin: 0 3px;
           background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            display: block;
            border-radius: 50%;
            opacity: 0.4;
        }

        .typing-indicator span:nth-of-type(1) { animation: typing 1.4s infinite; }
        .typing-indicator span:nth-of-type(2) { animation: typing 1.4s 0.2s infinite; }
        .typing-indicator span:nth-of-type(3) { animation: typing 1.4s 0.4s infinite; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-15px); opacity: 1; }
        }

        .input-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .text-input {
            flex: 1;
            padding: 15px 20px;
            font-size: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            outline: none;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: all 0.3s ease;
        }

        .text-input:focus {
border-color: #2563eb;
box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .submit-button {
           background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 15px;
            cursor: pointer;
           box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .submit-button:hover {
            transform: translateY(-2px);
          box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }

        .subject-dropdown {
            width: 100%;
            padding: 15px 20px;
            font-size: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            outline: none;
            background: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .subject-dropdown:focus {
           border-color: #2563eb;
box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .info-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #fbbf24;
            color: #92400e;
            padding: 15px;
            border-radius: 15px;
            margin: 10px 0;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .success-box {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border: 2px solid #34d399;
            color: #065f46;
            padding: 15px;
            border-radius: 15px;
            margin: 10px 0;
            font-size: 0.95rem;
            line-height: 1.6;
            text-align: center;
        }

        .consent-container {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .consent-button {
            flex: 1;
            padding: 15px 20px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .consent-yes {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(72, 187, 120, 0.3);
        }

        .consent-no {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(245, 101, 101, 0.3);
        }

        .consent-yes:hover, .consent-no:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        @media (max-width: 480px) {
            body {
                padding: 3px;
                padding-top: 5px;
            }
            
            .chat-container {
                height: 98vh;
                border-radius: 12px;
            }
            
            .chat-header {
                padding: 12px;
            }
            
            .chat-header h1 {
                font-size: 1.2rem;
            }

            .chat-header p {
                font-size: 0.8rem;
            }
            
            .study-icon {
                font-size: 1.8rem;
                margin: 6px 0;
            }

            .home-button {
                width: 32px;
                height: 32px;
                top: 8px;
                right: 8px;
                font-size: 0.85rem;
            }
            
            .chat-messages {
                padding: 10px;
                gap: 10px;
            }
            
            .message {
                max-width: 90%;
                padding: 10px 14px;
                font-size: 0.9rem;
            }
            
            .option-button {
                font-size: 0.85rem;
                padding: 10px 14px;
            }

            .text-input {
                font-size: 0.85rem;
                padding: 10px 14px;
            }

            .submit-button {
                font-size: 0.85rem;
                padding: 10px 16px;
            }

            .subject-dropdown {
                font-size: 0.85rem;
                padding: 10px 14px;
            }

            .info-box {
                font-size: 0.8rem;
                padding: 10px;
            }

            .success-box {
                font-size: 0.85rem;
                padding: 10px;
            }

            .consent-button {
                font-size: 0.85rem;
                padding: 10px 14px;
            }

            .consent-container {
                gap: 10px;
                margin-top: 10px;
            }
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .chat-messages::-webkit-scrollbar-thumb {
           background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <button class="home-button" id="homeButton">
                <i class="fas fa-home"></i>
            </button>
            <div class="study-icon">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h1>‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt) ‡¨¶‡≠Ç‡¨∞‡≠Ä‡¨ï‡¨∞‡¨£ ‡¨∏‡¨π‡¨æ‡≠ü‡¨ï</h1>
            <p>‡¨§‡≠Å‡¨∞‡¨®‡≠ç‡¨§ ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¶‡≠Ç‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å!</p>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be added here dynamically -->
        </div>
    </div>

    <script>
        window.doubtBot = null;

        class DoubtBot {
            constructor() {
                this.chatMessages = document.getElementById('chatMessages');
                this.homeButton = document.getElementById('homeButton');
                this.userContext = {};
                window.doubtBot = this;
                
                this.init();
            }

            init() {
                this.homeButton.addEventListener('click', () => this.resetChat());
                this.startChat();
            }

            startChat() {
                const welcomeMessage = `‡¨®‡¨Æ‡¨∏‡≠ç‡¨ï‡¨æ‡¨∞! üëã ‡¨è‡¨π‡¨ø ‡¨Æ‡¨û‡≠ç‡¨ö‡¨∞‡≠á ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨∏‡≠ç‡≠±‡¨æ‡¨ó‡¨§! ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt) ‡¨¶‡≠Ç‡¨∞ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡¨∞‡≠á ‡¨Æ‡≠Å‡¨Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨Ø‡¨•‡¨æ‡¨∏‡¨Æ‡≠ç‡¨≠‡¨¨ ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨ø‡¨¨‡¨ø ‡•§ ‡¨™‡¨æ‡¨† ‡¨∏‡¨Æ‡≠ç‡¨¨‡¨®‡≠ç‡¨ß‡≠Ä‡≠ü ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨ï‡≠å‡¨£‡¨∏‡¨ø ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt) ‡¨Ö‡¨õ‡¨ø ‡¨ï‡¨ø?`;

                this.typeWriter(welcomeMessage, () => {
                    this.showOptions([
                        { text: '‚úÖ ‡¨π‡¨Å, ‡¨Æ‡≠ã‡¨∞ ‡¨è‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt) ‡¨Ö‡¨õ‡¨ø', action: 'haveDoubt' },
                        { text: '‚ùå ‡¨®‡¨æ, ‡¨Æ‡≠ã‡¨∞ ‡¨ï‡≠å‡¨£‡¨∏‡¨ø ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt)‡¨®‡¨æ‡¨π‡¨ø‡¨Å', action: 'noDoubt' }
                    ]);
                });
            }

            handleUserChoice(choice, action) {
                this.addUserMessage(choice);
                this.removeOptions();

                switch(action) {
                    case 'haveDoubt':
                        this.askSubject();
                        break;
                    case 'noDoubt':
                        this.showExploreMessage();
                        break;
                    case 'submitDoubt':
                        this.askDoubtDetails();
                        break;
                    case 'changeSubject':
                        this.askSubject();
                        break;
                    case 'confirmSubmission':
                        this.showWhatsAppConsent();
                        break;
                    case 'editDoubt':
                        this.askDoubtDetails();
                        break;
                    case 'newDoubt':
                        this.askSubject();
                        break;
                    case 'exit':
                        this.showFarewellMessage();
                        break;
                    default:
                        this.startChat();
                }
            }

            askSubject() {
                const message = `‡¨¨‡¨π‡≠Å‡¨§ ‡¨≠‡¨≤! ‡¨Ø‡≠á‡¨â‡¨Å ‡¨¨‡¨ø‡¨∑‡≠ü‡¨∞‡≠á ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt) ‡¨Ö‡¨õ‡¨ø, ‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨§‡¨æ‡¨π‡¨æ ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å:`;
                
                this.typeWriter(message, () => {
                    this.showSubjectDropdown();
                });
            }

<option value="Meaning of Writ</option>
                        <option value="Need for Writs</option>
                        <option value="Uses of Writ</option>
                        <option value="Filing of Writ</option>
                        <option value="Working of Writ</option>
                        <option value="Meaning of Writ</option>


            
            showSubjectDropdown() {
                const dropdownContainer = document.createElement('div');
                dropdownContainer.id = 'subjectContainer';
                dropdownContainer.innerHTML = `
                    <select id="subjectSelect" class="subject-dropdown">
                        <option value="">-- ‡¨ó‡≠ã‡¨ü‡¨ø‡¨è ‡¨¨‡¨ø‡¨∑‡≠ü ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å --</option>
                        <option value="Meaning of Writ">Meaning of Writ</option>
                        <option value="Need for Writs">Need for Writs</option>
                        <option value="Uses of Writ">Uses of Writ</option>
                        <option value="Filing of Writ">Filing of Writ</option>
                        <option value="Working of Writ">Working of Writ</option>
                        <option value="Types of Writ">Types of Writ</option>
                        <option value="Habeas Corpus">Habeas Corpus</option>
                        <option value="Mandamus">Mandamus</option>
                        <option value="Prohibition">Prohibition</option>
                        <option value="Certiorari">Certiorari</option>
                        <option value="Quo-Warranto">Quo-Warranto</option>
                    </select>
                    <div class="input-container">
                        <button class="submit-button" onclick="doubtBot.handleSubjectSelection()">
                            <i class="fas fa-check"></i> ‡¨Ü‡¨ó‡¨ï‡≠Å ‡¨¨‡¨¢‡¨®‡≠ç‡¨§‡≠Å
                        </button>
                    </div>
                `;
                
                this.chatMessages.appendChild(dropdownContainer);
                this.scrollToBottom();
            }

            handleSubjectSelection() {
                const select = document.getElementById('subjectSelect');
                const selectedSubject = select.value;
                
                if (!selectedSubject) {
                    alert('‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨™‡≠ç‡¨∞‡¨•‡¨Æ‡≠á ‡¨ó‡≠ã‡¨ü‡¨ø‡¨è ‡¨¨‡¨ø‡¨∑‡≠ü ‡¨¨‡¨æ‡¨õ‡¨®‡≠ç‡¨§‡≠Å!');
                    return;
                }
                
                this.userContext.subject = selectedSubject;
                
                const container = document.getElementById('subjectContainer');
                if (container) {
                    container.remove();
                }
                
                this.addUserMessage(selectedSubject);
                
                const confirmMessage = `‡¨Ü‡¨™‡¨£ ‡¨¨‡¨æ‡¨õ‡¨ø‡¨õ‡¨®‡≠ç‡¨§‡¨ø: **${selectedSubject}**

‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡¨Æ‡¨æ‡¨®, ‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π‡¨ï‡≠Å ‡¨¨‡¨ø‡¨∏‡≠ç‡¨§‡≠É‡¨§ ‡¨≠‡¨æ‡¨¨‡¨∞‡≠á ‡¨¨‡¨∞‡≠ç‡¨£‡≠ç‡¨£‡¨®‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§ ‡¨Ü‡¨™‡¨£ ‡¨Ø‡≠á‡¨§‡≠á ‡¨Ö‡¨ß‡¨ø‡¨ï ‡¨∏‡≠Ç‡¨ö‡¨®‡¨æ ‡¨¶‡≠á‡¨¨‡≠á, ‡¨Æ‡≠Å‡¨Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨∏‡≠á‡¨§‡≠á ‡¨≠‡¨≤ ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨ø‡¨™‡¨æ‡¨∞‡¨ø‡¨¨‡¨ø!`;
                
                this.typeWriter(confirmMessage, () => {
                    this.showDoubtInput();
                });
            }

            showDoubtInput() {
                const inputContainer = document.createElement('div');
                inputContainer.id = 'doubtInputContainer';
                inputContainer.innerHTML = `
                    <div class="info-box">
                        <strong>üí° ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¨‡¨∞‡≠ç‡¨£‡≠ç‡¨£‡¨®‡¨æ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨ü‡¨ø‡¨™‡≠ç‡¨∏:</strong><br>
                        ‚Ä¢ ‡¨¨‡¨ø‡¨∑‡≠ü ‡¨®‡¨æ‡¨Æ ‡¨â‡¨≤‡≠ç‡¨≤‡≠á‡¨ñ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å<br>
                        ‚Ä¢ ‡¨™‡≠ç‡¨∞‡¨∂‡≠ç‡¨® ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ ‡¨â‡¨≤‡≠ç‡¨≤‡≠á‡¨ñ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å (‡¨Ø‡¨¶‡¨ø ‡¨•‡¨æ‡¨è)<br>
                        ‚Ä¢ ‡¨Ü‡¨™‡¨£ ‡¨ï‡¨£ ‡¨¨‡≠Å‡¨ù‡¨ø‡¨™‡¨æ‡¨∞‡≠Å‡¨®‡¨æ‡¨π‡¨æ‡¨Å‡¨®‡≠ç‡¨§‡¨ø ‡¨§‡¨æ‡¨π‡¨æ ‡¨≤‡≠á‡¨ñ‡¨®‡≠ç‡¨§‡≠Å
                   
                    </div>
                    <div class="input-container" style="flex-direction: column; gap: 10px;">
                        <textarea id="doubtText" class="text-input" rows="5" 
                            placeholder="‡¨â‡¨¶‡¨æ‡¨π‡¨∞‡¨£: ‡¨Ö‡¨Æ‡≠Å‡¨ï ‡¨™‡¨æ‡¨†‡¨ü‡¨ø ‡¨Æ‡≠Å‡¨Å ‡¨¨‡≠Å‡¨ù‡¨ø‡¨™‡¨æ‡¨∞‡≠Å‡¨®‡¨æ‡¨π‡¨ø‡¨Å ‡•§ ‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨Æ‡≠ã‡¨§‡≠á ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ..."></textarea>
                        <button class="submit-button" onclick="doubtBot.handleDoubtSubmission()" style="width: 100%;">
                            <i class="fas fa-paper-plane"></i> ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt) ‡¨¶‡¨æ‡¨ñ‡¨≤ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å
                        </button>
                    </div>
                `;
                
                this.chatMessages.appendChild(inputContainer);
                this.scrollToBottom();
            }

            handleDoubtSubmission() {
                const doubtText = document.getElementById('doubtText').value.trim();
                
                if (!doubtText) {
                    alert('‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨¶‡¨æ‡¨ñ‡¨≤ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡≠Ç‡¨∞‡≠ç‡¨¨‡¨∞‡≠Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¨‡¨∞‡≠ç‡¨£‡≠ç‡¨£‡¨®‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å!');
                    return;
                }
                
                if (doubtText.length < 10) {
                    alert('‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¨‡¨ø‡¨∑‡≠ü‡¨∞‡≠á ‡¨Ö‡¨ß‡¨ø‡¨ï ‡¨¨‡¨ø‡¨¨‡¨∞‡¨£‡≠Ä ‡¨¶‡¨ø‡¨Ö‡¨®‡≠ç‡¨§‡≠Å (‡¨Ö‡¨§‡¨ø ‡¨ï‡¨Æ‡¨∞‡≠á ‡≠ß‡≠¶ ‡¨Ö‡¨ï‡≠ç‡¨∑‡¨∞)‡•§');
                    return;
                }
                
                this.userContext.doubt = doubtText;
                
                const container = document.getElementById('doubtInputContainer');
                if (container) {
                    container.remove();
                }
                
                this.addUserMessage(doubtText);
                
                this.showDoubtSummary();
            }

            showDoubtSummary() {
                const message = `‡¨è‡¨†‡¨æ‡¨∞‡≠á ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π‡¨∞ ‡¨∏‡¨æ‡¨∞‡¨æ‡¨Ç‡¨∂ ‡¨Ö‡¨õ‡¨ø:

**‡¨¨‡¨ø‡¨∑‡≠ü:** ${this.userContext.subject}

**‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π:**
${this.userContext.doubt}

‡¨Ü‡¨™‡¨£ ‡¨è‡¨π‡¨æ‡¨ï‡≠Å ‡¨π‡≠ç‡¨¨‡¨æ‡¨ü‡≠ç‡¨∏‡¨Ü‡¨™‡≠ç ‡¨Æ‡¨æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨∞‡≠á ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï‡¨ô‡≠ç‡¨ï‡≠Å ‡¨™‡¨†‡¨æ‡¨á‡¨¨‡¨æ‡¨ï‡≠Å ‡¨ö‡¨æ‡¨π‡≠Å‡¨Å‡¨õ‡¨®‡≠ç‡¨§‡¨ø ‡¨ï‡¨ø?`;
                
                this.typeWriter(message, () => {
                    this.showOptions([
                        { text: '‚úÖ ‡¨π‡¨Å, ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï‡¨ô‡≠ç‡¨ï‡≠Å ‡¨™‡¨†‡¨æ‡¨®‡≠ç‡¨§‡≠Å', action: 'confirmSubmission' },
                        { text: '‚úèÔ∏è ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨∏‡¨Ç‡¨∂‡≠ã‡¨ß‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å', action: 'editDoubt' },
                        { text: 'üîÑ ‡¨¨‡¨ø‡¨∑‡≠ü ‡¨¨‡¨¶‡¨≥‡¨æ‡¨®‡≠ç‡¨§‡≠Å', action: 'changeSubject' }
                    ]);
                });
            }

            askDoubtDetails() {
                const message = `‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π‡¨ï‡≠Å ‡¨™‡≠Å‡¨£‡¨ø ‡¨Ö‡¨ß‡¨ø‡¨ï ‡¨¨‡¨ø‡¨¨‡¨∞‡¨£‡≠Ä ‡¨∏‡¨π‡¨ø‡¨§ ‡¨¨‡¨∞‡≠ç‡¨£‡≠ç‡¨£‡¨®‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å:`;
                
                this.typeWriter(message, () => {
                    this.showDoubtInput();
                });
            }

            showWhatsAppConsent() {
                const message = `‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π(Doubt) ‡¨π‡≠ç‡¨¨‡¨æ‡¨ü‡≠ç‡¨∏‡¨Ü‡¨™‡≠ç ‡¨Æ‡¨æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨∞‡≠á ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï‡¨ô‡≠ç‡¨ï‡≠Å ‡¨™‡¨†‡¨æ‡¨Ø‡¨ø‡¨¨ ‡•§

‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï ‡¨™‡≠ç‡¨∞‡¨æ‡¨™‡≠ç‡¨§ ‡¨ï‡¨∞‡¨ø‡¨¨‡≠á:
‚Ä¢ ‡¨¨‡¨ø‡¨∑‡≠ü: ${this.userContext.subject}
‚Ä¢ ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨¨‡¨ø‡¨∏‡≠ç‡¨§‡≠É‡¨§ ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π
‚Ä¢ ‡¨∏‡¨Æ‡≠ü ‡¨ö‡¨ø‡¨π‡≠ç‡¨®

‡¨Ü‡¨™‡¨£ ‡¨Ü‡¨ó‡¨ï‡≠Å ‡¨¨‡¨¢‡¨ø‡¨¨‡¨æ‡¨ï‡≠Å ‡¨ö‡¨æ‡¨π‡≠Å‡¨Å‡¨õ‡¨®‡≠ç‡¨§‡¨ø ‡¨ï‡¨ø?`;
                
                this.typeWriter(message, () => {
                    this.showConsentOptions();
                });
            }

            showConsentOptions() {
                const consentContainer = document.createElement('div');
                consentContainer.className = 'consent-container';
                consentContainer.id = 'consentContainer';
                
                const yesButton = document.createElement('button');
                yesButton.className = 'consent-button consent-yes';
                yesButton.innerHTML = '<i class="fas fa-check"></i> ‡¨π‡¨Å, ‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡¨Æ‡¨æ‡¨® ‡¨™‡¨†‡¨æ‡¨®‡≠ç‡¨§‡≠Å';
                yesButton.onclick = () => this.handleConsent(true);
                
                const noButton = document.createElement('button');
                noButton.className = 'consent-button consent-no';
                noButton.innerHTML = '<i class="fas fa-times"></i> ‡¨¨‡¨æ‡¨§‡¨ø‡¨≤ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å';
                noButton.onclick = () => this.handleConsent(false);
                
                consentContainer.appendChild(yesButton);
                consentContainer.appendChild(noButton);
                this.chatMessages.appendChild(consentContainer);
                this.scrollToBottom();
            }

            handleConsent(consent) {
                const consentContainer = document.getElementById('consentContainer');
                if (consentContainer) {
                    consentContainer.remove();
                }

                if (consent) {
                    this.addUserMessage('‡¨π‡¨Å, ‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡¨Æ‡¨æ‡¨® ‡¨™‡¨†‡¨æ‡¨®‡≠ç‡¨§‡≠Å');
                    const confirmMessage = `‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨π‡≠ç‡¨¨‡¨æ‡¨ü‡≠ç‡¨∏‡¨Ü‡¨™‡≠ç ‡¨Æ‡¨æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨∞‡≠á ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï‡¨ô‡≠ç‡¨ï‡≠Å ‡¨™‡¨†‡¨æ‡¨Ø‡¨æ‡¨â‡¨õ‡¨ø...`;
                    
                    this.typeWriter(confirmMessage, () => {
                        setTimeout(() => {
                            this.openWhatsApp();
                            this.showSuccessMessage();
                        }, 1000);
                    });
                } else {
                    this.addUserMessage('‡¨¨‡¨æ‡¨§‡¨ø‡¨≤ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å');
                    const cancelMessage = `‡¨ï‡≠å‡¨£‡¨∏‡¨ø ‡¨∏‡¨Æ‡¨∏‡≠ç‡≠ü‡¨æ ‡¨®‡¨æ‡¨π‡¨ø‡¨Å! ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨™‡¨†‡¨æ‡¨Ø‡¨æ‡¨á‡¨®‡¨æ‡¨π‡¨ø‡¨Å ‡•§

‡¨Ü‡¨™‡¨£ ‡¨ï‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡¨ï‡≠Å ‡¨ö‡¨æ‡¨π‡≠Å‡¨Å‡¨õ‡¨®‡≠ç‡¨§‡¨ø?`;
                    
                    this.typeWriter(cancelMessage, () => {
                        this.showOptions([
                            { text: '‚úèÔ∏è ‡¨Æ‡≠ã ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨∏‡¨Ç‡¨∂‡≠ã‡¨ß‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å', action: 'editDoubt' },
                            { text: 'üìö ‡¨®‡≠Ç‡¨Ü ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¶‡¨æ‡¨ñ‡¨≤ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å', action: 'newDoubt' },
                            { text: 'üè† ‡¨Æ‡≠Ç‡¨≥‡¨ï‡≠Å ‡¨Ø‡¨æ‡¨Ü‡¨®‡≠ç‡¨§‡≠Å', action: 'exit' }
                        ]);
                    });
                }
            }

            openWhatsApp() {
                const phoneNumber = "918260233303"; // Replace with teacher's WhatsApp number
                const timestamp = new Date().toLocaleString('en-IN', { 
                    timeZone: 'Asia/Kolkata',
                    dateStyle: 'medium',
                    timeStyle: 'short'
                });
                
                const message = encodeURIComponent(
`üéì *‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨æ‡¨∞‡≠ç‡¨•‡≠Ä‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¶‡¨æ‡¨ñ‡¨≤‡¨æ*

üìÖ *‡¨§‡¨æ‡¨∞‡¨ø‡¨ñ ‡¨ì ‡¨∏‡¨Æ‡≠ü:* ${timestamp}

üìö *‡¨¨‡¨ø‡¨∑‡≠ü:* ${this.userContext.subject}

‚ùì *‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨æ‡¨∞‡≠ç‡¨•‡≠Ä‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π:*
${this.userContext.doubt}

---
_‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨æ‡¨∞‡≠ç‡¨•‡≠Ä‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨∏‡¨π‡¨æ‡≠ü‡¨ï ‡¨Æ‡¨æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨∞‡≠á ‡¨™‡¨†‡¨æ‡¨Ø‡¨æ‡¨á‡¨õ‡¨ø_`
                );
                
                const whatsappURL = `https://wa.me/${phoneNumber}?text=${message}`;
                window.open(whatsappURL, '_blank');
            }

            showSuccessMessage() {
                const successBox = document.createElement('div');
                successBox.className = 'success-box';
                successBox.innerHTML = `
                    <div style="font-size: 3rem; margin-bottom: 10px;">‚úÖ</div>
                    <strong>‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨∏‡¨´‡¨≥‡¨§‡¨æ‡¨™‡≠Ç‡¨∞‡≠ç‡¨¨‡¨ï ‡¨™‡¨†‡¨æ‡¨Ø‡¨æ‡¨á‡¨õ‡¨ø!</strong><br><br>
                    ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï ‡¨π‡≠ç‡¨¨‡¨æ‡¨ü‡≠ç‡¨∏‡¨Ü‡¨™‡≠ç ‡¨Æ‡¨æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨∞‡≠á ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨™‡¨æ‡¨á‡¨õ‡¨®‡≠ç‡¨§‡¨ø ‡¨è‡¨¨‡¨Ç ‡¨∂‡≠Ä‡¨ò‡≠ç‡¨∞ ‡¨â‡¨§‡≠ç‡¨§‡¨∞ ‡¨¶‡≠á‡¨¨‡≠á‡•§<br><br>
                    üì± ‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï‡¨ô‡≠ç‡¨ï ‡¨â‡¨§‡≠ç‡¨§‡¨∞ ‡¨™‡¨æ‡¨á‡¨Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨π‡≠ç‡¨¨‡¨æ‡¨ü‡≠ç‡¨∏‡¨Ü‡¨™‡≠ç ‡¨Ø‡¨æ‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§
                `;
                this.chatMessages.appendChild(successBox);
                this.scrollToBottom();

                setTimeout(() => {
                    this.showOptions([
                        { text: 'üìö ‡¨Ö‡¨®‡≠ç‡≠ü ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¶‡¨æ‡¨ñ‡¨≤ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å', action: 'newDoubt' },
                        { text: 'üëã ‡¨¨‡¨æ‡¨π‡¨æ‡¨∞‡¨ï‡≠Å ‡¨Ø‡¨æ‡¨Ü‡¨®‡≠ç‡¨§‡≠Å', action: 'exit' }
                    ]);
                }, 1500);
            }

            showExploreMessage() {
                const message = `‡¨§‡¨æ‡¨π‡¨æ ‡¨è‡¨ï‡¨¶‡¨Æ ‡¨†‡¨ø‡¨ï‡≠ç! üòä

‡¨Ø‡≠á‡¨§‡≠á‡¨¨‡≠á‡¨≥‡≠á ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨ï‡≠å‡¨£‡¨∏‡¨ø ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨•‡¨ø‡¨¨ ‡¨∏‡≠á‡¨§‡≠á‡¨¨‡≠á‡¨≥‡≠á ‡¨¶‡≠ü‡¨æ‡¨ï‡¨∞‡¨ø ‡¨Æ‡≠ã ‡¨™‡¨æ‡¨ñ‡¨ï‡≠Å ‡¨´‡≠á‡¨∞‡¨ø ‡¨Ü‡¨∏‡¨®‡≠ç‡¨§‡≠Å ‡•§ ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨≠‡¨≤ ‡¨≠‡¨æ‡¨¨‡¨∞‡≠á ‡¨∂‡¨ø‡¨ñ‡¨ø‡¨¨‡¨æ‡¨∞‡≠á ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡¨ï‡≠Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï ‡¨∏‡¨∞‡≠ç‡¨¨‡¨¶‡¨æ ‡¨è‡¨†‡¨æ‡¨∞‡≠á ‡¨Ö‡¨õ‡¨®‡≠ç‡¨§‡¨ø‡•§

‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨Ö‡¨ß‡≠ç‡≠ü‡≠ü‡¨® ‡¨™‡¨æ‡¨á‡¨Å ‡¨∂‡≠Å‡¨≠‡¨ï‡¨æ‡¨Æ‡¨®‡¨æ! üìö‚ú®`;
                
                this.typeWriter(message, () => {
                    setTimeout(() => this.resetChat(), 3000);
                });
            }

            showFarewellMessage() {
                const message = `‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨æ‡¨∞‡≠ç‡¨•‡≠Ä ‡¨∏‡¨®‡≠ç‡¨¶‡≠á‡¨π ‡¨¶‡≠Ç‡¨∞‡≠Ä‡¨ï‡¨∞‡¨£ ‡¨∏‡¨π‡¨æ‡≠ü‡¨ï ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨ø‡¨•‡¨ø‡¨¨‡¨æ‡¨∞‡≠Å ‡¨ß‡¨®‡≠ç‡≠ü‡¨¨‡¨æ‡¨¶! üéì

‡¨Æ‡¨®‡≠á‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å:
‚Ä¢ ‡¨™‡≠ç‡¨∞‡¨∂‡≠ç‡¨® ‡¨™‡¨ö‡¨æ‡¨∞‡¨ø‡¨¨‡¨æ‡¨ï‡≠Å ‡¨ï‡≠á‡¨¨‡≠á ‡¨π‡≠á‡¨≤‡≠á ‡¨∏‡¨Ç‡¨ï‡≠ã‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨®‡¨æ‡¨π‡¨ø‡¨Å
‚Ä¢ ‡¨∂‡¨ø‡¨ñ‡¨ø‡¨¨‡¨æ ‡¨è‡¨ï ‡¨Ø‡¨æ‡¨§‡≠ç‡¨∞‡¨æ, ‡¨ó‡¨®‡≠ç‡¨§‡¨¨‡≠ç‡≠ü ‡¨®‡≠Å‡¨π‡≠á‡¨Å
‚Ä¢ ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨∏‡¨Æ‡¨∞‡≠ç‡¨•‡¨® ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡¨ï‡≠Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨ï ‡¨è‡¨†‡¨æ‡¨∞‡≠á ‡¨Ö‡¨õ‡¨®‡≠ç‡¨§‡¨ø

‡¨Ö‡¨ß‡≠ç‡≠ü‡≠ü‡¨® ‡¨ú‡¨æ‡¨∞‡¨ø ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å ‡¨è‡¨¨‡¨Ç ‡¨ú‡¨ø‡¨ú‡≠ç‡¨û‡¨æ‡¨∏‡≠Å ‡¨∞‡≠Å‡¨π‡¨®‡≠ç‡¨§‡≠Å! üìö‚ú®
`;
                
                this.typeWriter(message, () => {
                    setTimeout(() => this.resetChat(), 4000);
                });
            }

            typeWriter(message, callback) {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.innerHTML = '<span></span><span></span><span></span>';
                this.chatMessages.appendChild(typingDiv);
                this.scrollToBottom();

                setTimeout(() => {
                    if (typingDiv.parentNode) {
                        typingDiv.parentNode.removeChild(typingDiv);
                    }

                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'message bot-message';
                    this.chatMessages.appendChild(messageDiv);
                    
                    let i = 0;
                    let currentText = '';
                    
                    const type = () => {
                        if (i < message.length) {
                            currentText += message.charAt(i);
                            messageDiv.innerHTML = currentText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>');
                            i++;
                            this.scrollToBottom();
                            setTimeout(type, 10);
                        } else {
                            if (callback) {
                                setTimeout(callback, 300);
                            }
                        }
                    };
                    
                    type();
                }, 1000);
            }

            addUserMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user-message';
                messageDiv.textContent = message;
                this.chatMessages.appendChild(messageDiv);
                this.scrollToBottom();
            }

            showOptions(options) {
                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'options-container';
                optionsContainer.id = 'currentOptions';
                
                options.forEach(option => {
                    const button = document.createElement('button');
                    button.className = 'option-button';
                    button.innerHTML = option.text;
                    button.onclick = () => this.handleUserChoice(option.text.replace(/<[^>]*>/g, '').replace(/[^\w\s]/gi, ' ').trim(), option.action);
                    optionsContainer.appendChild(button);
                });
                
                this.chatMessages.appendChild(optionsContainer);
                this.scrollToBottom();
            }

            removeOptions() {
                const currentOptions = document.getElementById('currentOptions');
                if (currentOptions) {
                    currentOptions.remove();
                }
            }

            scrollToBottom() {
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }

            resetChat() {
                this.chatMessages.innerHTML = '';
                this.userContext = {};
                this.startChat();
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            new DoubtBot();
        });
    </script>
</body>
</html>
